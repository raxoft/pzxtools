PZX scripts documentation
=========================

The PZX tools suite contains few scripts which demonstrate the possibilities
of processing the PZX files dumped as text files. Such text files are
generated by pzx2txt and can be converted back to PZX by txt2pzx.
See PZX text format specification for more details about the format itself.

The scripts themselves are simple perl scripts which read the input from
standard input and write the output to standard output.

The following scripts are currently available.

expand_pulses.pl
----------------

This script expands the  pulses so each pulse is on a separate line, as if
pzx2txt -e was used in the first place.

Some scripts may require their input expanded in this way.

adjust_pulses.pl	
----------------

This script may be used to adjust pulse durations by specified scale factor
and bias. It even supports use of different factor and bias depending on
whether the pulse level is low or high. This may be useful if the pulses
were created using either too low or too high level threshold. Note that
in this case the script needs the pulses expanded, see expand_pulses.pl.

The script first multiplies each pulse duration by scale factor, then adds
the bias value. Both factor and bias are chosen according to current pulse
level. The resulting value is clamped to <0,2^32-1> range and output.

The scaling factor and bias is set by use of SCALE and BIAS keywords in the
input stream. The syntax is as follows:

SCALE [a] [b]

This sets the scaling factors for low and high pulses to values a and b,
respectively. If b is not present, both factors are set to a. If neither a
nor b is present, both factors are set to 1.

BIAS [a] [b]

This sets the bias for low and high pulses to values a and b,
respectively. If b is not present, both biases are set to a. If neither a
nor b is present, both biases are set to 0.

Example:

	SCALE 0.9 1.1	- Fix effect of sampling threshold biased towards high pulses.
	SCALE 2		- Make every pulse twice as long.
	SCALE		- No more scaling.

	BIAS 0 855	- Make every high pulse 855 T cycles longer.
	BIAS -10	- Make every pulse 10 T cycles shorter.
	BIAS		- No more biasing.

filter_pulses.pl
----------------

This script may be used to map pulse durations in certain ranges to
specified values. This is extremely useful for fixing rounding errors caused
by sampling.

The script maintains the list of ranges and the resulting value to use for
each range. Each pulse duration is compared with the list and the resulting
value of the first match is used instead. In case no match is found, the
duration itself is used as it is.

The ranges are set by use of FILTER keyword in the input stream. The syntax
is as follows:

FILTER <duration> <range>

Add mapping of durations in range <duration-range,duration+range> to
given duration to the list of range mappings.

FILTER <duration> <min> <max>

Add mapping of durations in range <min,max> to given duration to the list of
range mappings.

FILTER

Reset the range list.

Example:

	FILTER 855 600 1300	- Map anything within <600,1300> range to 855 T cycles.
	FILTER 0 100		- Map everything below 100 T cycles to zero.




History
=======

1.0 (16.6.2007)

+ initial release.
